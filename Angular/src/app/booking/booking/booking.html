<div class="container mt-4">
  @if (showDetails) {
    <div class="text-center mb-4">
      <h2>{{ showDetails.title }}</h2>
      <p class="text-muted">{{ showDetails.show_date }} at {{ showDetails.show_time }}</p>
    </div>
  }

  <div class="mb-5">
  <h4 class="mb-3">Select Your Seats</h4>

  <!-- نجمع الحروف الفريدة -->
  @for (row of getUniqueRows(); track row) {
    <div class="mb-3">
      <h5>
        @switch (getSeatClassForRow(row)) {
          @case ('first') {
            First Class ({{ row }})
          }
          @case ('second') {
            Second Class ({{ row }})
          }
          @default {
            Standard Class ({{ row }})
          }
        }
      </h5>
      <div class="d-flex flex-wrap gap-2">
        @for (seat of getSeatsByRow(row); track seat.id) {
          <button
            class="btn"
            [class.btn-secondary]="!seat.is_booked && !isSeatSelected(seat.id)"
            [class.btn-warning]="seat.is_booked"
            [class.btn-primary]="isSeatSelected(seat.id)"
            (click)="toggleSeat(seat)"
            [disabled]="seat.is_booked"
            style="width: 60px; height: 60px; font-size: 0.9rem;"
          >
            {{ seat.seat_number }}
          </button>
        }
      </div>
    </div>
  }

  <!-- دليل الألوان -->
  <div class="mt-3 text-center">
    <small class="text-muted">
      <span class="bg-secondary text-white px-2 py-1 rounded me-2">Available</span>
      <span class="bg-warning text-dark px-2 py-1 rounded me-2">Booked</span>
      <span class="bg-primary text-white px-2 py-1 rounded">Selected</span>
    </small>
  </div>
</div>

  <!-- قائمة الطعام -->
  <div class="mb-4">
    <h4 class="mb-3">Add Food & Drinks</h4>
    <div class="row">
      @for (item of foodItems; track item.id) {
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
              <div>
                <h6 class="mb-1">{{ item.name }}</h6>
                <small class="text-muted">${{ item.price }}</small>
              </div>
              <div class="d-flex align-items-center">
                <button
                  class="btn btn-outline-secondary btn-sm"
                  (click)="updateFoodQuantity(item.id, -1)"
                >
                  -
                </button>
                <span class="mx-2">{{ selectedFood[item.id] || 0 }}</span>
                <button
                  class="btn btn-outline-secondary btn-sm"
                  (click)="updateFoodQuantity(item.id, 1)"
                >
                  +
                </button>
              </div>
            </div>
          </div>
        </div>
      }
    </div>
  </div>

  <!-- الإجمالي وزر التأكيد -->
  <div class="text-center">
    <h4 class="mb-3">Total: ${{ calculateTotal().toFixed(2) }}</h4>
    <button
      class="btn btn-success btn-lg"
      (click)="submitBooking()"
      [disabled]="selectedSeatIds.length === 0"
    >
      Confirm Booking
    </button>
  </div>
</div>